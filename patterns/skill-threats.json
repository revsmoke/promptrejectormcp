{
  "version": 1,
  "patterns": [
    {
      "id": "skill-hidden-instructions-keywords",
      "name": "Hidden instructions with suspicious keywords",
      "description": "Detects HTML comments containing ignore/override/bypass/secret/hidden keywords",
      "pattern": "<!--[\\s\\S]*?(ignore|override|bypass|secret|hidden)[\\s\\S]*?-->",
      "flags": "gi",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasHiddenInstructions",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-hidden-instructions-commands",
      "name": "Hidden commands in HTML comments",
      "description": "Detects HTML comments containing curl/wget/bash/exec/eval commands",
      "pattern": "<!--[\\s\\S]*?(curl|wget|bash|exec|eval)[\\s\\S]*?-->",
      "flags": "gi",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasHiddenInstructions",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-bash-network",
      "name": "Bash network access to non-whitelisted domains",
      "description": "Detects bash with curl/wget accessing non-whitelisted domains",
      "pattern": "bash.*?(curl|wget)\\s+.*?https?:\\/\\/(?!(?:localhost|127\\.0\\.0\\.1|github\\.com|npmjs\\.com))",
      "flags": "gi",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": ["localhost", "127.0.0.1", "github.com", "npmjs.com"]
    },
    {
      "id": "skill-dangerous-bash-destructive",
      "name": "Bash destructive filesystem commands",
      "description": "Detects bash with rm -rf, dd if=, mkfs, format",
      "pattern": "bash.*?(rm\\s+-rf|dd\\s+if=|mkfs|format)",
      "flags": "gi",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-bash-privilege",
      "name": "Bash privilege escalation",
      "description": "Detects bash with sudo, su, chmod 777, chown",
      "pattern": "bash.*?(sudo|su\\s+|chmod\\s+777|chown)",
      "flags": "gi",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-bash-process",
      "name": "Bash process killing",
      "description": "Detects bash with kill -9, killall, pkill",
      "pattern": "bash.*?(kill\\s+-9|killall|pkill)",
      "flags": "gi",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-standalone-network",
      "name": "Standalone curl/wget in code blocks",
      "description": "Detects curl/wget commands in code blocks accessing non-whitelisted domains",
      "pattern": "(?:^|\\s|```)(bash|sh|zsh)?\\s*(curl|wget)\\s+.*?https?:\\/\\/(?!(?:localhost|127\\.0\\.0\\.1|github\\.com|npmjs\\.com))",
      "flags": "gim",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": ["localhost", "127.0.0.1", "github.com", "npmjs.com"]
    },
    {
      "id": "skill-dangerous-standalone-destructive",
      "name": "Standalone destructive commands in code blocks",
      "description": "Detects rm -rf, dd if=, mkfs, format in code blocks",
      "pattern": "(?:^|\\s|```)(bash|sh|zsh)?\\s*(rm\\s+-rf|dd\\s+if=|mkfs|format)",
      "flags": "gim",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-standalone-privilege",
      "name": "Standalone privilege escalation in code blocks",
      "description": "Detects sudo, su, chmod 777, chown in code blocks",
      "pattern": "(?:^|\\s|```)(bash|sh|zsh)?\\s*(sudo|su\\s+|chmod\\s+777|chown)",
      "flags": "gim",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-dangerous-standalone-process",
      "name": "Standalone process killing in code blocks",
      "description": "Detects kill -9, killall, pkill in code blocks",
      "pattern": "(?:^|\\s|```)(bash|sh|zsh)?\\s*(kill\\s+-9|killall|pkill)",
      "flags": "gim",
      "severity": "critical",
      "category": "shell_injection",
      "flagGroup": "hasDangerousToolUsage",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-sensitive-etc-files",
      "name": "System password/auth file access",
      "description": "Detects access to /etc/passwd, /etc/shadow, /etc/sudoers",
      "pattern": "\\/etc\\/(passwd|shadow|sudoers)",
      "flags": "gi",
      "severity": "high",
      "category": "data_exfiltration",
      "flagGroup": "hasSensitiveFileAccess",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-sensitive-ssh-keys",
      "name": "SSH key file access",
      "description": "Detects access to SSH private keys and authorized_keys",
      "pattern": "~?\\/.ssh\\/(id_rsa|id_ed25519|authorized_keys)",
      "flags": "gi",
      "severity": "high",
      "category": "data_exfiltration",
      "flagGroup": "hasSensitiveFileAccess",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-sensitive-aws-creds",
      "name": "AWS credentials file access",
      "description": "Detects access to ~/.aws/credentials or ~/.aws/config",
      "pattern": "~?\\/.aws\\/(credentials|config)",
      "flags": "gi",
      "severity": "high",
      "category": "data_exfiltration",
      "flagGroup": "hasSensitiveFileAccess",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-sensitive-env-files",
      "name": ".env file access",
      "description": "Detects access to .env, .env.local, .env.production, .env.development files",
      "pattern": "(?:^|\\/|\\\\|~\\/|\\.\\/|['\"`\\s])\\.env(?:\\.local|\\.production|\\.development)?(?:$|\\s|['\"`]|\\/)",
      "flags": "gim",
      "severity": "high",
      "category": "data_exfiltration",
      "flagGroup": "hasSensitiveFileAccess",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-sensitive-git-config",
      "name": ".git/config access",
      "description": "Detects access to .git/config which may contain credentials",
      "pattern": "\\.git\\/config",
      "flags": "gi",
      "severity": "high",
      "category": "data_exfiltration",
      "flagGroup": "hasSensitiveFileAccess",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-obfuscation-base64",
      "name": "Base64 encoded content",
      "description": "Detects large Base64 encoded strings that may hide commands",
      "pattern": "[A-Za-z0-9+/]{40,}={0,2}",
      "flags": "g",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasObfuscation",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 5, "singleMatchLength": 200 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-obfuscation-hex",
      "name": "Hex encoding",
      "description": "Detects hex-encoded byte sequences",
      "pattern": "\\\\x[0-9a-fA-F]{2}",
      "flags": "g",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasObfuscation",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 5, "singleMatchLength": 200 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-obfuscation-unicode",
      "name": "Unicode escape sequences",
      "description": "Detects Unicode escape sequences used for obfuscation",
      "pattern": "\\\\u[0-9a-fA-F]{4}",
      "flags": "g",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasObfuscation",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 5, "singleMatchLength": 200 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-obfuscation-zero-width",
      "name": "Zero-width characters",
      "description": "Detects zero-width Unicode characters used to hide content",
      "pattern": "[\\u200B-\\u200D\\uFEFF]",
      "flags": "g",
      "severity": "medium",
      "category": "obfuscation",
      "flagGroup": "hasObfuscation",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 5, "singleMatchLength": 200 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-social-engineering-urgency",
      "name": "Urgency/authority language",
      "description": "Detects words suggesting fake urgency or authority",
      "pattern": "\\b(official|urgent|critical|immediate|security update|required|mandatory)\\b",
      "flags": "gi",
      "severity": "medium",
      "category": "social_engineering",
      "flagGroup": "hasSocialEngineering",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 2 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-social-engineering-authority",
      "name": "Fake authority claims",
      "description": "Detects claims of authorization from known AI/tech companies",
      "pattern": "\\b(from Anthropic|from Claude|from OpenAI|authorized by|approved by)\\b",
      "flags": "gi",
      "severity": "medium",
      "category": "social_engineering",
      "flagGroup": "hasSocialEngineering",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 2 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-social-engineering-trust",
      "name": "Trust manipulation language",
      "description": "Detects phrases designed to build false trust",
      "pattern": "\\b(trust me|don't worry|safe to|guaranteed|certified)\\b",
      "flags": "gi",
      "severity": "medium",
      "category": "social_engineering",
      "flagGroup": "hasSocialEngineering",
      "scope": "skill",
      "detection": { "mode": "threshold", "countThreshold": 2 },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-exfil-url-params",
      "name": "URL parameter exfiltration",
      "description": "Detects HTTP requests to non-whitelisted domains with sensitive query parameters",
      "pattern": "https?:\\/\\/(?!(?:localhost|127\\.0\\.0\\.1|github\\.com|npmjs\\.com|api\\.github\\.com))[\\w.-]+.*?[\\?&](data|key|token|secret|password)=",
      "flags": "gi",
      "severity": "critical",
      "category": "data_exfiltration",
      "flagGroup": "hasNetworkExfiltration",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": ["localhost", "127.0.0.1", "github.com", "npmjs.com", "api.github.com"]
    },
    {
      "id": "skill-exfil-curl-post-data",
      "name": "curl/wget POST with sensitive data",
      "description": "Detects curl/wget commands POSTing sensitive data (keys, tokens, passwords)",
      "pattern": "(curl|wget).*?(-d|--data|--data-binary).*?(key|token|secret|password|env)",
      "flags": "gi",
      "severity": "critical",
      "category": "data_exfiltration",
      "flagGroup": "hasNetworkExfiltration",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "skill-exfil-dns",
      "name": "DNS exfiltration via subshell",
      "description": "Detects nslookup with command substitution for DNS exfiltration",
      "pattern": "nslookup.*?\\$\\(",
      "flags": "gi",
      "severity": "critical",
      "category": "data_exfiltration",
      "flagGroup": "hasNetworkExfiltration",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    },
    {
      "id": "shell-metacharacters",
      "name": "Shell metacharacters",
      "description": "Detects dangerous shell metacharacters: & | ; ` $",
      "pattern": "[&|;`$]",
      "flags": "g",
      "severity": "high",
      "category": "shell_injection",
      "flagGroup": "hasShellInjection",
      "scope": "skill",
      "detection": { "mode": "simple" },
      "enabled": true,
      "source": "original",
      "cveRefs": [],
      "dateAdded": "2025-01-01",
      "whitelistedDomains": []
    }
  ]
}
